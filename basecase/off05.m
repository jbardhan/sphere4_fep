boxlength = 26.8483333587646;
ksi = 2.837;
CONV = 332.112;
forwardNegQ = [ 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1 ]';
forwardNegTotals = [ 1.72079 3.18415 4.3207 5.21067 5.93637 6.12682 6.14286 6.02987 5.56366 4.78961 3.66219 2.19487 0.435484 -1.49253 -3.75813 -6.2899 -9.31355 -12.5203 -16.1312 -20.0964 ]';
reversedBackwardNegTotals = [ 1.7018 3.10412 4.29432 5.189087 5.71217 6.103849 6.0335431 5.5606501 4.9766291 4.1367501 3.0147201 1.5738001 -0.150649900000001 -2.3479799 -4.8094199 -7.7187699 -10.8001399 -14.0760999 -17.7565299 -21.7264299 ]';
q = [-1+((1)-(-1))*forwardNegQ];
correctedFNtotals = forwardNegTotals - 0.5*ksi*CONV*(q.^2 - (-1).^2) / boxlength;
correctedBNtotals = reversedBackwardNegTotals - 0.5*ksi*CONV*(q.^2-(-1).^2) / boxlength;
Qdata = [q; q]; 
Edata = [correctedFNtotals; correctedBNtotals;];
lsmatConstrained = [Qdata.^2 Qdata];
lsmatUnconstrained = [Qdata.^2 Qdata ones(length(Qdata),1)];
xConstrained = lsmatConstrained \ Edata;
xUnconstrained = lsmatUnconstrained \ Edata;
L_constrained = xConstrained(1);
L_unconstrained = xUnconstrained(1);
phiStatic_constrained = xConstrained(2);
phiStatic_unconstrained = xUnconstrained(2);
offset_unconstrained = xUnconstrained(3);
