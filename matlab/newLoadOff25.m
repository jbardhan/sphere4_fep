boxlength = 26.8483333587646;
ksi = 2.837;
CONV = 332.112;
forwardNegQ = [0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32 0.34 0.36 0.38 0.4 0.42 0.44 0.46 0.48 0.5 0.52 0.54 0.56 0.58 0.6 0.62 0.64 0.66 0.68 0.7 0.72 0.74 0.76 0.78 0.8 0.82 0.84 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1 ]';
forwardNegTotals = [2.64681 5.23469 7.71852 10.0976 12.3621 14.5943 16.6937 18.7209 20.5834 22.419 24.1564 25.8125 27.347 28.7285 30.133 31.2944 32.4124 33.5191 34.5829 35.4837 36.3002 36.9724 37.5506 38.0628 38.5494 38.9069 39.1714 39.3964 39.5187 39.5613 39.5358 39.4624 39.2818 39.0452 38.7177 38.3266 37.8747 37.3706 36.7815 36.0973 35.3917 34.5688 33.6759 32.7105 31.6929 30.6066 29.449 28.2221 26.9657 25.6061 ]';
reversedBackwardNegTotals = [ 2.65112 5.1783 7.6295 9.95587 12.17365 14.34669 16.46372 18.46459 20.37816 22.21879 23.86791 25.48185 27.02367 28.48609 29.86639 31.09621 32.27346 33.31633 34.25314 35.068748 35.844815 36.5087 37.119964 37.648905 38.094228 38.476394 38.771716 38.980841 39.102039 39.1517049 39.0881543 38.9885816 38.8588216 38.5559436 38.2544586 37.9122936 37.4546606 36.9493086 36.3312276 35.6867346 34.9766376 34.2051416 33.3296236 32.3926926 31.3590626 30.2720826 29.1124826 27.8994826 26.5666826 25.2222426 ]';
q = [-1; -1+((1)-(-1))*forwardNegQ];
Izero = find(abs(q)< 1e-3);
correctedFNtotals = [0; forwardNegTotals] - 0.5*ksi*CONV*(q.^2 - (-1).^2) / boxlength;
correctedFNtotals = correctedFNtotals - correctedFNtotals(Izero);
correctedBNtotals = [0;reversedBackwardNegTotals] -reversedBackwardNegTotals(Izero) - 0.5*ksi*CONV*(q.^2-(-1).^2) / boxlength;
correctedBNtotals = correctedBNtotals - correctedBNtotals(Izero);
Qdata = [q; q]; 
Edata = [correctedFNtotals; correctedBNtotals;];
lsmatConstrained = [Qdata.^2 Qdata];
lsmatUnconstrained = [Qdata.^2 Qdata ones(length(Qdata),1)];
xConstrained = lsmatConstrained \ Edata;
xUnconstrained = lsmatUnconstrained \ Edata;
L_constrained = xConstrained(1);
L_unconstrained = xUnconstrained(1);
phiStatic_constrained = xConstrained(2);
phiStatic_unconstrained = xUnconstrained(2);
offset_unconstrained = xUnconstrained(3);
off25 = struct('boxlength',boxlength,'q',q,'forwardNegQ',forwardNegQ,'forwardNegTotals',forwardNegTotals,'reversedBackwardNegTotals',reversedBackwardNegTotals, 'correctedFNtotals',correctedFNtotals,'correctedBNtotals',correctedBNtotals,'Qdata',Qdata,'Edata',Edata,'lsmatConstrained',lsmatConstrained,'lsmatUnconstrained',lsmatUnconstrained,'xConstrained',xConstrained,'xUnconstrained',xUnconstrained,'L_constrained',L_constrained,'L_unconstrained',L_unconstrained,'phiStatic_constrained',phiStatic_constrained,'phiStatic_unconstrained',phiStatic_unconstrained,'offset_unconstrained',offset_unconstrained);
