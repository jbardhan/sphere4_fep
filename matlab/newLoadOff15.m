boxlength = 26.8483333587646;
ksi = 2.837;
CONV = 332.112;
forwardNegQ = [0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32 0.34 0.36 0.38 0.4 0.42 0.44 0.46 0.48 0.5 0.52 0.54 0.56 0.58 0.6 0.62 0.64 0.66 0.68 0.7 0.72 0.74 0.76 0.78 0.8 0.82 0.84 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1 ]';
forwardNegTotals = [1.87456 3.68957 5.48353 7.17611 8.79551 10.3644 11.8632 13.31 14.6789 16.012 17.2601 18.4463 19.5639 20.662 21.7024 22.6494 23.5369 24.3613 25.1422 25.8442 26.4955 27.1151 27.657 28.152 28.5836 28.934 29.2647 29.5612 29.7613 29.9328 30.0398 30.12 30.142 30.066 29.9478 29.7921 29.5676 29.298 28.9607 28.6055 28.1854 27.681 27.151 26.5778 25.9156 25.2374 24.483 23.6981 22.8592 21.9381 ]';
reversedBackwardNegTotals = [ 1.83918 3.66095 5.41746 7.07967 8.66945 10.2425 11.73221 13.15981 14.5221 15.84685 17.11144 18.29147 19.40753 20.44339 21.44998 22.424891 23.32498 24.16532 24.954277 25.676585 26.333647 26.93303 27.465217 27.960283 28.426898 28.819441 29.130797 29.401858 29.622879 29.764006 29.8597777 29.9306849 29.9278042 29.8626404 29.7266544 29.5531764 29.3386404 29.0589504 28.7217554 28.3424794 27.9338604 27.4269374 26.8944714 26.2837234 25.6555454 24.9493514 24.1961234 23.3899924 22.5009524 21.6064694 ]';
q = [-1; -1+((1)-(-1))*forwardNegQ];
Izero = find(abs(q)< 1e-3);
correctedFNtotals = [0; forwardNegTotals] - 0.5*ksi*CONV*(q.^2 - (-1).^2) / boxlength;
correctedFNtotals = correctedFNtotals - correctedFNtotals(Izero);
correctedBNtotals = [0;reversedBackwardNegTotals] -reversedBackwardNegTotals(Izero) - 0.5*ksi*CONV*(q.^2-(-1).^2) / boxlength;
correctedBNtotals = correctedBNtotals - correctedBNtotals(Izero);
Qdata = [q; q]; 
Edata = [correctedFNtotals; correctedBNtotals;];
lsmatConstrained = [Qdata.^2 Qdata];
lsmatUnconstrained = [Qdata.^2 Qdata ones(length(Qdata),1)];
xConstrained = lsmatConstrained \ Edata;
xUnconstrained = lsmatUnconstrained \ Edata;
L_constrained = xConstrained(1);
L_unconstrained = xUnconstrained(1);
phiStatic_constrained = xConstrained(2);
phiStatic_unconstrained = xUnconstrained(2);
offset_unconstrained = xUnconstrained(3);
off15 = struct('boxlength',boxlength,'q',q,'forwardNegQ',forwardNegQ,'forwardNegTotals',forwardNegTotals,'reversedBackwardNegTotals',reversedBackwardNegTotals, 'correctedFNtotals',correctedFNtotals,'correctedBNtotals',correctedBNtotals,'Qdata',Qdata,'Edata',Edata,'lsmatConstrained',lsmatConstrained,'lsmatUnconstrained',lsmatUnconstrained,'xConstrained',xConstrained,'xUnconstrained',xUnconstrained,'L_constrained',L_constrained,'L_unconstrained',L_unconstrained,'phiStatic_constrained',phiStatic_constrained,'phiStatic_unconstrained',phiStatic_unconstrained,'offset_unconstrained',offset_unconstrained);
